pluginManagement {
    def flutterSdkPath = "$settingsDir/local.properties"
    if (new File(flutterSdkPath).exists()) {
        Properties flutterProperties = new Properties()
        flutterProperties.load(new FileInputStream(flutterSdkPath))
        if (flutterProperties.containsKey("flutter.sdk")) {
            settings.ext.flutterSdkPath = flutterProperties.getProperty("flutter.sdk")
        }
    }
    
    repositories {
        google()
        mavenCentral()
        gradlePluginPortal()
    }
}

include ':app'

// هذا الجزء يضمن ربط مكتبات الطرف الثالث بشكل صحيح
def flutterProjectRoot = settingsDir.parentFile
def plugins = new Properties()
def pluginsFile = new File(flutterProjectRoot, '.flutter-plugins')
if (pluginsFile.exists()) {
    pluginsFile.withReader('UTF-8') { reader -> plugins.load(reader) }
}

plugins.each { name, path ->
    def pluginDirectory = flutterProjectRoot.resolve(path)
    include ":$name"
    project(":$name").projectDir = pluginDirectory
}
